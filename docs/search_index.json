[
["index.html", "Seminário Latinoamericano: Instrumentos y metodologias para un observatório de Clima y su impacto en la salud humana Curso de R, contaminacion atmosferica y mas Aprender Git Clonar este contenido", " Seminário Latinoamericano: Instrumentos y metodologias para un observatório de Clima y su impacto en la salud humana Sergio Ibarra-Espinosa, Universidade de São Paulo, sergio.ibarra@usp.br, ibarraespinosa.github.io 2019-09-11 Curso de R, contaminacion atmosferica y mas Este curso online contendra las sisgueinetes informaciones Sistemas de informacion con dartos de salud en Chile (gracias Paty Matus) Impacto de las emisiones antropogenicas en la salud y clima R desde Excel Leer y procesar vectores espaciales con sf (Pebesma 2018) Leer y procesar informacion en grillas espaciales (raster) con stars(Pebesma 2019) y raster(Hijmans 2019) Aprender Git Para aprender GIT puedes ver: https://git-scm.com/book/es/v1/Empezando https://learngitbranching.js.org/ https://try.github.io/ Clonar este contenido Para clonar este contenido haz: git clone https://github.com/ibarraespinosa/UBA.git References "],
["intro.html", "Chapter 1 Sistemas de informacion con datos de salud en Chile 1.1 Encuesta Nacional de Salud (ENS) 1.2 Departamento de Estadisticas e Informaciones de Salud 1.3 Epidemiologia 1.4 Encuesta de caracterizacion socioeconomica (CASEN) 1.5 Estadisticas generales 1.6 CEPAL STAT 1.7 Banco Interamericano de Desarrollo 1.8 Datos de contaminacion atmosferica y meteorologia 1.9 Algunos exemplos de datos de series de tiempo", " Chapter 1 Sistemas de informacion con datos de salud en Chile Sistema de información en salud existentes Enfasis en las fuentes de información y las escala temporal/espacial que manejan Series de tiempo disponible por fuente Instituciones a cargo de la captura, procesamiento y análisis Disponibilidad de los datos e indicadores que producen Otros 1.1 Encuesta Nacional de Salud (ENS) La ENS es una encuesta realizada por el Ministerio de Salud para identificar cuales son las enfermedades que sufren y los tratamientos que reciben todas las personas con mas de 15 años que viven en Chile. De esta forma es posible es posible realizar diagnosticos, identificar problemas y formular politicas planes y proyectos para mejor la salud de las personas. Organismo responsable: Ministerio de Salud, Departamento de Epidemiología Gobierno de Chile. Organismo ejecutor: Pontificia Universidad Católica de Chile (PUC). Población objetivo: Personas de 15 años y más, chilenas o extranjeras que residen habitualmente en viviendas particulares ocupadas, localizadas en zonas urbanas y rurales de las quince regiones de Chile. Representatividad: Nacional, regional y Urbano/Rural. Modo de aplicación: Entrevista personal en hogar (Sistema de captura electrónica: Tablet), aplicada por encuestador y profesional enfermera de acuerdo al tipo de cuestionario. Período de trabajo de campo: Agosto 2016 a marzo 2017 Tamaño muestral: 6.233 encuestados, de los cuales 5.520 cuentan con exámenes de laboratorio de acuerdo a protocolo. 37,1% hombres, 62,9% mujeres. Error muestral: Error absoluto de muestreo de 2,6% a nivel nacional, raíz del efecto de diseño de 1,797, estimaciones con 95% de confianza y error relativo inferior a 30%. Algunos resultados: Consumo de tabaco: 66,7% no fuma, 33,$ fuma. Consumo riesgoso de alcohol 11,7%, 20,5% hombres, 3,3% mujeres. Sedentarismo: 86,7%, 83,3% hombre, 90.0% mujeres. Estado nutricional: 1,3% enfraquecido, 24,5% normal, 39,8% sobrepeso, 31,2% obeso, 3,2% obeso morbido. Sospecha de hipertension: 27,6%. Sospecha de diabetes: 12,3%. Autoreporte de infarto agudo al miocardio: 3,3%. Autoreporte de ataque cerebro vascular: 2,6%. Fuentes: https://www.minsal.cl/wp-content/uploads/2017/11/ENS-2016-17_PRIMEROS-RESULTADOS.pdf https://www.minsal.cl/wp-content/uploads/2018/01/2-Resultados-ENS_MINSAL_31_01_2018.pdf http://www.encuestas.uc.cl/ens/index.html 1.2 Departamento de Estadisticas e Informaciones de Salud Resúmenes estadísticos mensuales (REM). Vea el manual Defunciones Egresos Nacimientos Atenciones de urgencia Enfermedades de notificacion obligatoria Enfermedades transmitidas por alimentos Tuberculosis 1.3 Epidemiologia Vigilancia Epidemiologica 1.4 Encuesta de caracterizacion socioeconomica (CASEN) “La Encuesta de Caracterización Socioeconómica Nacional (Casen) del Ministerio de Desarrollo Social es una encuesta a hogares, de carácter multipropósito, es decir, que abarca diversos temas como educación, trabajo, ingresos, salud, entre otros; además es una encuesta transversal, por lo tanto, incluye a todo el espectro de la población del país.” 1.5 Estadisticas generales Instituto Nacional de Estadisticas 1.6 CEPAL STAT Estadisticos e indicadores Perfiles Nacionales Publicaciones y estadisticas 1.7 Banco Interamericano de Desarrollo Educacion Mercado Laboral Ingreso Pobreza Demografia 1.8 Datos de contaminacion atmosferica y meteorologia SINCA QUALAR RESEARCH DATA ARCHIVE CMIP AchemMip IPCC DATA RCP TELECONNECTIONS 1.9 Algunos exemplos de datos de series de tiempo Efecto de la contamiancion atmosferica sobre los accidentes cerebros vasculares Figure 1.1: Accidentes Cerebro Vasculares Chile (Leiva et al., 2013) "],
["impacto-de-las-emisiones-antropogenicas-en-la-calidad-del-aire-y-clima.html", "Chapter 2 Impacto de las emisiones antropogénicas en la calidad del aire y clima 2.1 Contaminacion atmosferica - Introduccion 2.2 Contaminantes atmosfericos 2.3 Forzantes climaticos y gases de efecto invernadero 2.4 Emisiones y sus fuentes 2.5 Nuevos modelos de emisiones: VEIN 2.6 Nuevos datos, satelites y modelacion inversa", " Chapter 2 Impacto de las emisiones antropogénicas en la calidad del aire y clima La contaminacion es una amenaza a la salud global que causo 9 millones de muertes en 2015, 16% de las muertes (Landrigan et al. 2018). Ademas, existe consenso cientifico de la existencia y relacion con la actividad humana sobre el cambio climatico (Cook et al. 2016). Tanto la contaminacion atmosferica como los gases de efecto invernadero, conocidos tambien como forzantes climaticos de vida corta y larga son causados por compuestos quimicos liberados en la atmosfera, las llamadas emisiones. Por lo tanto, es importante realziar y entender la caracterizacion espacial y temporal de las emisiones, asi como sus efectos en la salud y en el clima. Algunos efectos de la contaminacion atmosferica en la salud incrementa la morbilidad, natalidad aumenta la tasa de nacimientos con problemas (menos peso, inteligencia) incrementa riesgo de cancer etc et etc La atmosfera es una delgada capa sobre la tierra, 50% de su masa esta 5.6 km esta compuestos por varios gases (Brasseur and Jacob 2017), cuya composicion es: Gas Razon molar \\(mol \\cdot mol^{-1}\\) Principal fuente y comentarios (Brasseur et al. 1999) Nitrogeno (\\(N_2\\)) 0.78 Biologica Oxigeno (\\(O_2\\)) 0.21 Biologica Argon (\\(A_r\\)) 0.0093 Inerte Dioxido de carbono (\\(CO_2\\)) \\(400 \\cdot10^{-6}\\) Combustion, oceano, biosfera Neon (\\(N_e\\)) \\(18 \\cdot10^{-6}\\) Inerte Ozono (\\(O_3\\)) \\(0.01-10 \\cdot10^{-6}\\) Fotoquimico Helio (\\(H_e\\)) \\(5.2 \\cdot10^{-6}\\) Inerte Metano (\\(CH_4\\)) \\(1.8 \\cdot10^{-6}\\) Biogenico y antropogenico Hidrogeno (\\(H_2\\)) \\(500 \\cdot10^{-9}\\) Biogenico, antropogenico y fotoquimico Oxido nitroso (\\(N_2O\\)) \\(330 \\cdot10^{-9}\\) Biogenico y antropogenico 2.1 Contaminacion atmosferica - Introduccion “La contaminación del aire es un determinante importante de la salud. La OMS estima que en 2012 alrededor de 1 de cada 8 muertes se atribuyeron a la exposición a la contaminación del aire, lo que lo convierte en el mayor factor de riesgo ambiental para la mala salud.”(OMS 2019) La ciencia de la contaminacion atmosferica, si bien reciente, ha sido desarrollada debido a los avances de en la comprension de la meteorologia. Problemas relacionados con la contaminacion atmosferica han sido descritos en obras literarias y cartas a lo largo de la historia. Por ejemplo, se cree que el primer caso reportado sobre los efectos de la contaminacion atmosférica en la salud es sobre Gaius Plinius Secundus, Geografo, (AD 23-AD 79), quien habria fallecido los efectos de la emisiones del volcan Vesuvius (Pulles and Helsinga 2010; Wikipedia contributors 2019d). La erupcion del volcan Vesuvius duro 19 horas, con altura de lacolumna entre 14 y 32 km y deposicion de material piroplastico de hasta 2500 \\(kg \\cdot m^{-2}\\) (Macedonio, Pareschi, and Santacroce 1988). Figure 2.1: An eruption of Vesuvius seen from Portici, by Joseph Wright (ca. 1774-6), Dominio Publico Sin embargo han sido los grandes episodios de contaminacion los que han gatillado su estudio y gestion por parte de los tomadores de decisiones. Entre ellos se pueden mencionar el desastre de Londres 1952 y la acidifacion de los lagos escandinavos. 2.1.1 El desastre de Londres 1952 Altas concentraciones de contaminantes fueron ocurrieron entre el 5 y 9 de Diciembre de 1952 en Londres, Inglaterra. Para comparacion, vea el monumento “Columna de Nelson” en condiciones normales(Wikipedia contributors 2019e), y el dia de la llamada “Gran Niebla de Londres”(Wikipedia contributors 2019b) Figure 2.2: Columna de Nelson, Dominio Publico Figure 2.3: Columna de Nelson durante la Gran Niebla de 1952, Dominio Publico 2.1.1.1 Consecuencias A pesar que durante la fecha, las autoridades no consideraron el efecto de la contaminacion, este evento si causoo gran impacto en la comunidad (Wikipedia contributors 2019c). Estudios posteriores cuantificaron un impacto en 12.000 muertos asociados a este episodio de contaminacion (Bell and Davis 2001). Figure 2.4: Mortalidad semanal y concentraciones de SO2 en Lobres 1952 (Bell and Davis, 2001) Figure 2.5: Mortalidad semanal y concentraciones de SO2 en Lobres 1952 (Bell and Davis, 2001) comentarios? 2.1.1.2 CLRTAP ## Tarea / Tema de casa / Homework: ## [1] &quot;Investique que es, causas, consequencias y poltiica ambiental asociada a CLRTAP&quot; 2.2 Contaminantes atmosfericos Las emisiones liberadas a la atmosfera impactan la salud, meteorologia y clima en diferentes escalas como se ve en la sigueinte figura. Figure 2.6: Esquema de impacto de emisiones (Ibarra, 2017) Por lo tanto para entender las emisiones necesitamos respnder las siguientes preguntas: Que? Como? Cuando? Donde? Los contaminantes atmosfericos suelen ser clasificados como: Primarios: emitidos directamente en la atmosfera. Ejemplo: CO. Secundarios: formados en la atmosfera. Ejemplo: \\(O_3\\). Existen muchos contaminantes atmosfericos de interes cientifico como Ozono \\(O_3\\) Monoxido de Carbono \\(CO\\) Radicales de Oxidos de nitrogeno \\(NO_X \\equiv NO + NO_2\\) Compuestos organicos volatiles \\(COV\\) Radicales de Halogeno Especies de azufre \\(SO_2\\), \\(SO4\\), \\(H_2SO_4\\) Aersoles Cada contaminante tiene un extenso cuerpo teorico. En esta parte del curso nos referiremos brevemente al \\(O_3\\), aerosoles y especies de azufre, sin embargo, el estudiante puede revisar la bibliografia para se aprofundar. 2.2.1 Ozono \\(O_3\\) Respecto del ozono es necesario mencionar que existen dos tipos, el estratosferico (bueno) y y el troposferico (malo), como es expicado por Brasseur and Jacob (2017). El ciclo deo ozono troposferico comienza con la fotolisis de lamolecula de ox[igeno devido a radiacion solar de longitud de onda minimo 242 nm. Posteriormente, un atomo de oxigeno se combina con otra molecula de oxigeno para formar ozono. La molecula M (cuerpo inerte, como \\(N_2\\) o \\(O_2\\)) estabiliza la molecula de \\(O_3\\) recien formada. \\[\\begin{equation} O_2 + hv(\\lambda &lt; 242 nm) \\rightarrow O + O \\tag{2.1} \\end{equation}\\] \\[\\begin{equation} O + O_2 + M \\rightarrow O_3 + M \\tag{2.2} \\end{equation}\\] El Ozono luego es fotolizado a un atomo de oxigeno y una molecula de oxigeno ante radiacion menor a 1180 nm, liberando energia cinetica (Wikipedia contributors 2019f). En el caso del ozono troposfeico, la reaccion comienza quando el radical hidroxilo \\(\\cdot OH\\) oxida el \\(CO\\) generando el radical \\(\\cdot HOCO\\) que es inestable y reacciona rapidamente con \\(O_2\\) generando el peroxi radical \\(\\cdot HO_2\\) y \\(CO_2\\). El peroxi radical reacciona oxida \\(NO\\) generando \\(NO_2\\) y un radical hidroxilo. Luego el \\(NO_2\\) es fotolizado liberando un atomo de oxigeno que reacciona con la molecula de \\(O_2\\) generando \\(O_3\\). \\[\\begin{equation} O_3 + hv(\\lambda &lt; 1180 nm) \\rightarrow O + O_2 + energia cinetica \\tag{2.3} \\end{equation}\\] En el caso del ozono troposferico, los ingredientes principales son radiacion solar, \\(NO_x\\) y compuestos organicos volatiles (Wikipedia contributors 2019g). \\[\\begin{equation} \\cdot OH + CO \\rightarrow \\cdot HOCO \\tag{2.4} \\end{equation}\\] \\[\\begin{equation} \\cdot HOCO + O_2 \\rightarrow HO_2\\cdot + CO_2 \\tag{2.5} \\end{equation}\\] \\[\\begin{equation} HO_2\\cdot + NO \\rightarrow \\cdot OH + NO_2 \\tag{2.6} \\end{equation}\\] \\[\\begin{equation} NO_2 + hv(\\lambda &lt; 400nm) \\rightarrow NO + O \\tag{2.7} \\end{equation}\\] \\[\\begin{equation} O + O_2 \\rightarrow O_3 \\tag{2.8} \\end{equation}\\] Los mecanismos mostrados son un resumen de complejas reacciones en la atmosfera donde muchas otras reacciones y compuestos juegan un rol. 2.2.2 Especies de azufre El es un compuesto que reacciona generando importantes contaminantes como sulfatos y acido sulfurico, importantesen la lluvia aida (deposicion acida). Los combustibles tienen azufre y durante la combustion, el azufre es oxidado generando \\(SO_2\\), diesel tiene mayor cantidad de azufre que gasolina, por lo tanto generando mas \\(SO_2\\). Tambien existe el dimetilsulfido (DMS) \\((CH3)_2S\\), que es biogenico, asi como el carbonilo sulfido (COS), que largo tiempo de vida que permite su transporte a la estratosfera. A continuacion una resumen de los mecanismos de generacion de acido sulfurico (Brasseur and Jacob 2017). \\(SO_2\\) es oxiado por \\(OH\\) \\[\\begin{equation} SO_2 + OH + M \\rightarrow HSO_3 + M \\tag{2.9} \\end{equation}\\] \\[\\begin{equation} HSO_3 + O_2 \\rightarrow SO_3 + HO_2 \\tag{2.10} \\end{equation}\\] \\[\\begin{equation} SO_3 + H2O + M \\rightarrow H_2SO_4 + M \\tag{2.11} \\end{equation}\\] 2.2.3 Aerosoles Son particulas suspendidas desde ~0.001 \\(\\mu m\\) hasta 100 \\(\\mu m\\) (luster molecular a gota). Conocido como material particulado (MP), sus caracerizacion es realizada mayormente en base a su diametro aerodinamico como se muestra en la sigueinte figura (Wikipedia contributors 2019a)(Brasseur and Jacob 2017). Existen tres agrupaciones que son: Modo Aiken: nucleos de condensacion nuevos (fresh) que condensan (gas) o coagulan (liquidos). Diametro hasta 100 nm. Modo acumulacion: Diametro entre 100 y 1000 nm. Modo coarse: Diametro mayor que 1000 nm. Figure 2.7: Distribucion normalizada (suma es 1000) de aerosoles por diametro aerodinamico, Dominio Publico Los aersolos son claisficados por numeros, area de superficie y volumen. Normalmente las agencias de medio ambiente miden \\(MP_{10}\\) (diametro menos &lt;= que 10 \\(\\mu m\\)) y \\(MP_{2.5}\\) (diametro menos &lt;= que 2.5 \\(\\mu m\\)) en \\(\\mu g \\cdot m^{-3}\\). A continuacion una figura mostrando material particulado en Chile, Brazil y China. Chile * Figure 2.8: MP2.5 ug/m3 em Lautaro, Chile (https://sinca.mma.gob.cl/index.php/estacion/index/key/870) China Figure 2.9: MP2.5 ug/m3 em Hotan, China (http://pm25.in/hetiandiqu) ingrese aqui: https://aqicn.org/forecast/beijing/ Osasco, Brasil Figure 2.10: MP2.5 ug/m3 Osasco, Brasil (https://qualar.cetesb.sp.gov.br) NASA WORLDVIEW es un excelente recurso para monitorear aerosoles, incendios y mucho mas. ## Ingrese a https://worldview.earthdata.nasa.gov/ y busque aerosol 2.3 Forzantes climaticos y gases de efecto invernadero El efecto invernadero es un fenomeno que e produce naturalmente en la tierra, sin intervencion humana. Por ejemplo, concentraciones biogenicas de CO2 o el vapor de agua. Sin embargo, el termino forzante climatico se refiere de estos compuestos quimicos tienen una incidencia en el clima, pues alteran el cambio en iradiancia neta \\(W \\cdot m^{-2}\\). El forzante radiativo es utilizado como predictor de cambio en la media global de temperatura. IPCC (Schimel et al. 1996) define forzamiento radiativo como: “The radiative forcing of the surface-troposphere system due to the perturbation in or the introduction of an agent (say, a change in greenhouse gas concentrations) is the change in net (down minus up) irradiance (solar plus long-wave; in Wm−2) at the tropopause AFTER allowing for stratospheric temperatures to readjust to radiative equilibrium, but with surface and tropospheric temperatures and state held fixed at the unperturbed values” (Schimel et al. 1996) Del sitio web de Copernicus (https://atmosphere.copernicus.eu/climate-forcing: “Climate forcing measures the imbalance in the Earth’s energy budget caused by a perturbation of the climate system, for example changes in atmospheric composition driven by human activities. Climate forcing, also known as Radiative Forcing, therefore determines the change in globally-averaged temperature change due to the natural or human-induced changes to the energy budget. Increases in greenhouse gas concentrations over the industrial era are responsible for a positive climate forcing, causing a gain of energy in the climate system. In contrast, changes in atmospheric aerosol concentrations result in a negative climate forcing leading to a loss of energy. It is the balance between these various climate forcings that drive the change in global temperature.” https://atmosphere.copernicus.eu/climate-forcing Figure 2.11: Cambio en la temperatura media debido a forzantes radiativas (https://atmosphere.copernicus.eu/climate-forcing) Figure 2.12: Cambio en la temperatura media debido a forzantes radiativas (https://atmosphere.copernicus.eu/climate-forcing) Esta figura muestra un resumen de los compuestos y su forzante radiativo (FR) (Stocker 2014) Figure 2.13: Forzante radiativo (https://atmosphere.copernicus.eu/climate-forcing) 2.3.1 Efectos directos e indirectos de aerosoles Directo: Influencia en balance radiativo. Indirecto: Influencia en el climia. Primer efecto indirecto: microfisica de la precipitacion. Segundo efecto indirecto: Cantidad de lluvia. Figure 2.14: Forzantes indirectos (Robwood, 2019) (https://atmos.uw.edu/~robwood/teaching/591/ATMS_591_Albrecht_1989.pdf) 2.3.2 Black Carbon - Carbono negro Son particulas producto de la combustion incompleta de combustibles con origen antropogenico y biogenico. Considerado el segundo gas de efecto invernadero despues de CO2 (Bond et al. 2013). Figure 2.15: UNEP (https://twitter.com/UNEnvironment/status/1150404638501416961/photo/1 2.4 Emisiones y sus fuentes Un inventario de emisiones es la compilacion del flujo de masa de contaminantes emitida en un lugar y tiempo determinado. Son definidos por la ecuacion basica de : \\[\\begin{equation} E = FE \\cdot NA \\tag{2.12} \\end{equation}\\] Donde E es la emision, FE es el factor de emision y NA el nivel de actividad. Por ejemplo, si queremos saber las emisiones de vehiculos, FE esta en g/km, NA es la cantidad de vehiculos veces la distancia que recorren km en un tiempo determinado, luego E es la masa g de contaminantes. 2.4.1 Tipos Ya que ya sabemos los contaminantes y su forzamiento radiativo, podemos ver cuales son las fuentes de ellos, desde elpunto de vista de contaminacion atmosferica y clima. Existen varios tipos de fuentes de emisiones: Figure 2.16: Fuentes de emisiones Pueden tener aplicaciones de gestion y cientificas: Figure 2.17: Tipos de inventarios (Pules and Helsinga, 2013) Por ejemplo, IPCC entrega guias para que los paises compilen inventarios de emisiones de gases de fecto invernadero: Figure 2.18: Actualizacion en las guias de inventarios de emisiones IPCC (https://www.ipcc-nggip.iges.or.jp/public/2019rf/index.html) Ahora podemos ver como ha sido la serie de emisiones globales de gases de efecto invernadero: Figure 2.19: Serie de emisiones) Figure 2.20: CO2 y temperatura (http://www.ipcc.ch/report/graphics/)) 2.4.2 Calidad y criterio Un inventario de emisiones debe considerar la aseguracion de la calidad. En este sentido, los cientificos buscan errores, puntos debiles. Los tomadores de decisiones (UNFCC-IPCC) buscan consenso. Por lo tanto, la calidad para los inventarios cientificos consiste en que las estimaciones tienen que ser confirmadas, calibradas y validadas. Y en el plano politico, un inventario de calidad genera in acuerdo y protocolo que todos deben atacar (VEA CLRTAP) 2.4.3 Dimensiones Como cientificos necesitamos responder las siguentes preguntas: Que: Que contaminante (especifico) es emitido. Como: Cual es el proceso. Cuando: Caracterizacion temporal. Onde: Caracterizacion temporal. ** Mapas interactivos de Inventario de emisiones vehiculares de Sao Paulo (Ibarra 2017)** PM2.5 NOx CO HC 2.4.4 Categorias llave En los inventarios de emisiones muchas veces pocas categorias emiten la mayor cantidad de contaminantes. Estas son las categorias llave y es en ellas donde debemos invertir la mayor cantidad de esfuerzo y recurso economico. 2.4.5 Bottom-up y top-down En las guias de emisiones europeas, (2016) muestra la definicion de los enfoques bottom-up y top-down. Figure 2.21: Bottom up y top-down 2.4.6 Ejemplo de factores de emision (real-time GPS) Figure 2.22: (Ibarra-Espinosa et al., 2019 under-review) 2.5 Nuevos modelos de emisiones: VEIN En el ultimo par de años se han publicado nuevos modelos para el calculo de emisiones, como el Vehicular Emissions Inventory model (Ibarra-Espinosa et al. 2018) que consiste en una libreria en R (https://atmoschem.github.io/vein/). Figure 2.23: (Ibarra-Espinosa et al., 2018, https://atmoschem.github.io/vein/) Figure 2.24: (Ibarra-Espinosa et al., 2018, https://atmoschem.github.io/vein/) 2.6 Nuevos datos, satelites y modelacion inversa La modelacion inversa esta siendo utilizada para corregir y re estimar emisiones con los nuevos datos de satelite disponibles (Kaiser et al. 2018): Figure 2.25: (Kaiser et al., 2018) Columna total de NO2 en europa con Sentinel 5P libreria stars (Pebesma 2019) Figure 2.26: STARS! Sentinel 5P References "],
["taller-vectores-aplicacion-de-software-de-informacion-geografica-y-modelado.html", "Chapter 3 Taller VECTORES: Aplicación de software de información geográfica y modelado 3.1 Instalacion 3.2 R desde Excel, libreoffice, archivos de texto, etc. 3.3 Vectores 3.4 Geoprocesamiento", " Chapter 3 Taller VECTORES: Aplicación de software de información geográfica y modelado gracias Dra. Patricia Matus Nota: Existen diferentes recursos para aprender R, sf, stars y raster. Use Google, Baidu o duckduckgo www.github.com/r-spatial/sf www.github.com/r-spatial/stars www.github.com/rspatial/raster https://bookdown.org/ https://geocompr.robinlovelace.net/ https://www.datascienceatthecommandline.com/ https://bookdown.org/rdpeng/rprogdatascience/ NOTA: SI ALGUNA VEZ TE PIERDES USANDO ALGUNA FUNCION DE R, ESCRIBE ?FUNCION Por ejemplo, si tenemos dudas con la funcion aggregate, plot, read.csv ?aggregate ?plot ?read.csv NOTA: PARA COMENTAR, ESCRIBA # Por ejemplo, ?aggregate #importante! Esto abre la pagina del manual de la funcion aggregate 3.1 Instalacion Por favor instale las siguientes librerias en R, copie y peque (cole) en R: install.packages( c(&quot;sf&quot;, &quot;stars&quot;, &quot;cptcity&quot;, &quot;ggplot2&quot;, &quot;raster&quot;, &quot;ncdf4&quot;, &quot;RNetCDF&quot;, &quot;maps&quot;, &quot;data.table&quot;, &quot;readxl&quot;) ) Para correr el ejemplo de stars con Sentinel 5P instale la sigueinte libreria (1 Gb) install.packages( c(&quot;starsdata&quot;) ) Para realmente comenzar es necesario mencionar que R es un lenguaje de programacion estadistico libre (gratis y abierto) orientado a objeto escrito en C, con bindings directos para C++, C y Fortran. 3.2 R desde Excel, libreoffice, archivos de texto, etc. A veces debemos o obtenemos datos en hojas de calculo (Libreoffice Calc o Microsoft Office Excel). Cuando este archivo es pequeño no hay problema, pero la realidad es que cada vez es mas frecuente contar con grandes bases de datos y trabajar con un programa de interface grafica se hace dificil. Una de las razones es que la interfaz grafica consume muchos recursos computacionales, que podrian ser usados para el procesamiento de informacion. Por lo tanto 3.2.1 El Niño y la Niña “El Niño (La Niña) is a phenomenon in the equatorial Pacific Ocean characterized by a five consecutive 3-month running mean of sea surface temperature (SST) anomalies in the Niño 3.4 region that is above (below) the threshold of +0.5°C (-0.5°C). This standard of measure is known as the Oceanic Niño Index (ONI).” NOAA Vamos a leer la temperatura de la superficie del mar para calcular el indice ONI do (5 min) - Abra https://www.ncdc.noaa.gov/teleconnections/nao/data.csv - Como son los datos? - Cual es la separacion de las columnas? 3.2.2 Usando base url &lt;- &quot;http://www.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/detrend.nino34.ascii.txt&quot; # Leyendo datos oni = read.table(url, h = T) # construyendo la variable de fecha / data oni$Date &lt;- as.Date(paste0(oni$YR, ifelse(nchar(oni$MON) &lt; 2, paste0(0, oni$MON), oni$MON), &quot;01&quot;), format = &quot;%Y%m%d&quot;) # Extrayendo el año oni$Year &lt;- as.integer(strftime(oni$Date, &quot;%Y&quot;)) # Extrayendo el mes oni$Month &lt;- as.integer(strftime(oni$Date, &quot;%m&quot;)) # Definiendo la funcion de media movil ma &lt;- function(x, n = 3) { stats::filter(x, rep(1/n, n), sides = 2) } # Calculando la media movil oni$ONI &lt;- ma(oni$ANOM, 3) # Seleccionando las columnas de interes oni &lt;- oni[, c(&quot;Date&quot;, &quot;Year&quot;, &quot;Month&quot;, &quot;ONI&quot;)] # mostrando las primeras 6 observaciones de cada columna head(oni) ## Date Year Month ONI ## 1 1950-01-01 1950 1 NA ## 2 1950-02-01 1950 2 -1.336667 ## 3 1950-03-01 1950 3 -1.166667 ## 4 1950-04-01 1950 4 -1.183333 ## 5 1950-05-01 1950 5 -1.073333 ## 6 1950-06-01 1950 6 -0.850000 3.2.3 Usando data.table (mi favorito junto con sf) data.table es mas rapido que python, julia y spark https://h2oai.github.io/db-benchmark/ library(data.table) # Leyendo datos oni = fread(url, h = T) # construyendo la variable de fecha / data oni$Date &lt;- as.Date(paste0(oni$YR, ifelse(nchar(oni$MON) &lt; 2, paste0(0, oni$MON), oni$MON), &quot;01&quot;), format = &quot;%Y%m%d&quot;) # Extrayendo el año oni$Year &lt;- as.integer(strftime(oni$Date, &quot;%Y&quot;)) # Extrayendo el mes oni$Month &lt;- as.integer(strftime(oni$Date, &quot;%m&quot;)) # Definiendo la funcion de media movil ma &lt;- function(x, n = 3) { stats::filter(x, rep(1/n, n), sides = 2) } # Calculando la media movil oni$ONI &lt;- ma(oni$ANOM, 3) # Seleccionando las columnas de interes oni &lt;- oni[, c(&quot;Date&quot;, &quot;Year&quot;, &quot;Month&quot;, &quot;ONI&quot;)] # mostrando las primeras 6 observaciones de cada columna oni class(oni) Otras librerias para leer datos tabulares (planihas - spreadsheets): readxl readr 3.2.4 summary summary(oni) ## Date Year Month ONI ## Min. :1950-01-01 Min. :1950 Min. : 1.000 Min. :-2.033333 ## 1st Qu.:1967-05-24 1st Qu.:1967 1st Qu.: 3.000 1st Qu.:-0.536667 ## Median :1984-10-16 Median :1984 Median : 6.000 Median :-0.003333 ## Mean :1984-10-15 Mean :1984 Mean : 6.481 Mean : 0.032758 ## 3rd Qu.:2002-03-08 3rd Qu.:2002 3rd Qu.: 9.000 3rd Qu.: 0.560833 ## Max. :2019-08-01 Max. :2019 Max. :12.000 Max. : 2.643333 ## NA&#39;s :2 3.2.5 Ploteando datos con base ?plot hist(oni$ONI, main = &quot;Hitograma ONI&quot;) boxplot(oni$ONI, main = &quot;Boxplot de ONI&quot;) ?boxplot library(ggplot2) library(cptcity) ggplot(oni, aes(x = Date, y = ONI,colour = ONI)) + geom_line(size = 2)+ scale_colour_gradientn(colours = rev(cpt(find_cpt(&quot;cb_div_RdB&quot;)[2])), limit = c(-2.7, 2.7)) ## Don&#39;t know how to automatically pick scale for object of type ts. Defaulting to continuous. 3.3 Vectores GDAL es la libreria de abstraccion de datos espaciales. Permite leer diferentes tipos de datos de tipo vectores y [raster](https://gdal.org/drivers/raster/index.html. Algunos formatos de vectores: ESRI Shapefile Google Earth Engine Data API GeoJSON para html GeoPackage que es el nuevo formato estandard para la representacion de datos espaciales. Ver aqui. Nuevo estandard ISO (puntos, areas, lineas, volume, etc) GeoPackage, creado por la Open Geospatial Consortium, es un formato abierto y no propietario de datos espaciales sf significa Spatial Features y es una libreria con interface para las librerias GDAL, GEOS y PROJ que te premite trabajar con datos espaciales de una forma muy parecida que con una hoja de calculo normal. Como sf esta enlazada con GDAL, permite leer todos los formatos de vector de GDAL direcamente en R. Vamos a leer datos de Argentina en formato GeoJSON … Es demasiado OBVIO que podemos leer datos shapefile .shp, por eso para cambiar un poco vamos a leer GeoJSON datos bajados de IGN library(sf) ## Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0 df &lt;- read_sf(&quot;dados/provincia.json&quot;) head(df) ## Simple feature collection with 6 features and 8 fields ## geometry type: MULTIPOLYGON ## dimension: XYZ ## bbox: xmin: -71.96569 ymin: -41.10059 xmax: -58.33515 ymax: -29.50042 ## epsg (SRID): 4326 ## proj4string: +proj=longlat +datum=WGS84 +no_defs ## # A tibble: 6 x 9 ## entidad objeto fna gna nam in1 fdc sag ## &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 0 Provi… Ciud… Ciud… Ciud… 02 Geog… IGN ## 2 0 Provi… Prov… Prov… Neuq… 58 Geog… IGN ## 3 0 Provi… Prov… Prov… La P… 42 Geog… IGN ## 4 0 Provi… Prov… Prov… Mend… 50 Geog… IGN ## 5 0 Provi… Prov… Prov… San … 74 Geog… IGN ## 6 0 Provi… Prov… Prov… Córd… 14 Geog… IGN ## # … with 1 more variable: geometry &lt;MULTIPOLYGON [°]&gt; names(df) ## [1] &quot;entidad&quot; &quot;objeto&quot; &quot;fna&quot; &quot;gna&quot; &quot;nam&quot; &quot;in1&quot; ## [7] &quot;fdc&quot; &quot;sag&quot; &quot;geometry&quot; plot(df[&quot;geometry&quot;], main = &quot;Provincias de Argentina&quot;, axes = TRUE) Podemos seleccionar columnas y lineas igual a la forma que lo hicimos anteriormente, y ploteamos estos dados. head(df) ## Simple feature collection with 6 features and 8 fields ## geometry type: MULTIPOLYGON ## dimension: XYZ ## bbox: xmin: -71.96569 ymin: -41.10059 xmax: -58.33515 ymax: -29.50042 ## epsg (SRID): 4326 ## proj4string: +proj=longlat +datum=WGS84 +no_defs ## # A tibble: 6 x 9 ## entidad objeto fna gna nam in1 fdc sag ## &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 0 Provi… Ciud… Ciud… Ciud… 02 Geog… IGN ## 2 0 Provi… Prov… Prov… Neuq… 58 Geog… IGN ## 3 0 Provi… Prov… Prov… La P… 42 Geog… IGN ## 4 0 Provi… Prov… Prov… Mend… 50 Geog… IGN ## 5 0 Provi… Prov… Prov… San … 74 Geog… IGN ## 6 0 Provi… Prov… Prov… Córd… 14 Geog… IGN ## # … with 1 more variable: geometry &lt;MULTIPOLYGON [°]&gt; Vemos muchos datos, pero vamos a ver los datos unios por departamento. No estoy mostrando aqui pues son 435, pero ya se que vamos a seleccionar “Departamento Belgrano” unique(df$fna) ## [1] &quot;Ciudad Autónoma de Buenos Aires&quot; ## [2] &quot;Provincia del Neuquén&quot; ## [3] &quot;Provincia de La Pampa&quot; ## [4] &quot;Provincia de Mendoza&quot; ## [5] &quot;Provincia de San Luis&quot; ## [6] &quot;Provincia de Córdoba&quot; ## [7] &quot;Provincia de Santa Fe&quot; ## [8] &quot;Provincia de Entre Ríos&quot; ## [9] &quot;Provincia de San Juan&quot; ## [10] &quot;Provincia de La Rioja&quot; ## [11] &quot;Provincia de Catamarca&quot; ## [12] &quot;Provincia de Tucumán&quot; ## [13] &quot;Provincia de Jujuy&quot; ## [14] &quot;Provincia del Chaco&quot; ## [15] &quot;Provincia de Formosa&quot; ## [16] &quot;Provincia de Santiago del Estero&quot; ## [17] &quot;Provincia de Tierra del Fuego, Antártida e Islas del Atlántico Sur&quot; ## [18] &quot;Provincia de Santa Cruz&quot; ## [19] &quot;Provincia del Chubut&quot; ## [20] &quot;Provincia de Río Negro&quot; ## [21] &quot;Provincia de Buenos Aires&quot; ## [22] &quot;Provincia de Corrientes&quot; ## [23] &quot;Provincia de Misiones&quot; ## [24] &quot;Provincia de Salta&quot; La provincia 17 tiene un nombre muy largo, lo cambiamos asi: df$fna[17] &lt;- &quot;Provincia Antartida&quot; De todas maneras, el campo fna tiene muchas veces la pabra “Provincia”, camos a eliminarla. df$fna &lt;- gsub(pattern = &quot;Provincia &quot;, replacement = &quot;&quot;, x = df$fna) La siguiente linea de codigo es muy barbara / da hora / cool / la raja. Corran! library(mapview) mapview(df, zcol = &quot;fna&quot;, legend = T, alpha = 0.8) Ahora vamos a seleccionar Buenos Aires plot(df[df$fna == unique(df$fna)[1], &quot;entidad&quot;], axes = T, main = unique(df$fna)[1]) Ahora, vamos a extraer los centroids de cada poligono Recuerda, si tienes dudas de alguna funcion, clica ?FUNCION, por ejemplo, ?st_centroid cent &lt;- st_centroid(df) El warning se debe a que los datos que tenemos estan en latitud y longitud, y por lo visto, tenemos un dato con limites que no son correctos. Me parece que es la Antartida, debido se ve demasiado grande. Vamos a sacarla y ver como da cent &lt;- st_centroid(df[df$fna != &quot;Antartida&quot;, ]) Ahora vemos que tenemos un warning diferente. En este caso, st_centroid nos avisa que los geograficos son constantes, pero como sabemos, la tierra es un elipsoide, no una esfera perfecta. 3.4 Geoprocesamiento El geoprocesamiento incluye diferentes tareas como buffers y otros, como se ve en QGIS knitr::include_graphics(&quot;figs/geo.png&quot;) Iremos a calcular el buffer de cada centroid, sin embargo, primeros vamos a proyectar nuestros datos para UTM con un usado codigo llamado EPSG (European Petroleum Survey Group), como muestra este blog cafe geodesico. Asi cada provincia podria tener un EPSG diferente, para simplificar este curso, utilizaremos el codigo epsg 5346. Para transformar nuestros datos, tenemos que: dft &lt;- st_transform(cent, 5346) dft ## Simple feature collection with 23 features and 8 fields ## geometry type: POINT ## dimension: XY ## bbox: xmin: 3879876 ymin: 4569475 xmax: 5331263 ymax: 7419288 ## epsg (SRID): 5346 ## proj4string: +proj=tmerc +lat_0=-90 +lon_0=-63 +k=1 +x_0=4500000 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ## # A tibble: 23 x 9 ## entidad objeto fna gna nam in1 fdc sag ## &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 0 Provi… Ciud… Ciud… Ciud… 02 Geog… IGN ## 2 0 Provi… del … Prov… Neuq… 58 Geog… IGN ## 3 0 Provi… de L… Prov… La P… 42 Geog… IGN ## 4 0 Provi… de M… Prov… Mend… 50 Geog… IGN ## 5 0 Provi… de S… Prov… San … 74 Geog… IGN ## 6 0 Provi… de C… Prov… Córd… 14 Geog… IGN ## 7 0 Provi… de S… Prov… Sant… 82 Geog… IGN ## 8 0 Provi… de E… Prov… Entr… 30 Geog… IGN ## 9 0 Provi… de S… Prov… San … 70 Geog… IGN ## 10 0 Provi… de L… Prov… La R… 46 Geog… IGN ## # … with 13 more rows, and 1 more variable: geometry &lt;POINT [m]&gt; Luego, calculamos el buffer, que puede tener una distancia constante, o una distancia variable: dft_pro &lt;- st_buffer(x = dft, dist = 100000) # 100 km plot(dft_pro$geometry, axes = T) Macanudo /Bacan / barbaro / Chevere / Da Ora / Splendid / Cool! Podemos calcular perfectamente un buffer con una distancia variable….. dft_pro &lt;- st_buffer(x = dft, dist = rnorm(n = nrow(dft), mean = 100000, sd = 50000)) # 100 km plot(dft_pro$geometry, axes = T) Con este grafico hemos ploteado un buffer que tiene un comprimento alteatorio pero con una media de 100 km y un desvio padrao de 50 km, para marcar bien las posibilidades…. Antes de terminar, vamos plotear el area de cada buffer. Como el diametro fue calculado de forma aleatoria, en cada rodada este numero cambia, entonces: dft_pro$AREA &lt;- st_area(dft_pro) plot(dft_pro[&quot;AREA&quot;], axes = T) # Area em m^2 Honestamente, puedes hacer muuuchas cosas. Vamos a plotear la primera linea dft_pro1 &lt;- dft_pro[1, ] #primera linea plot(dft_pro1[&quot;AREA&quot;], axes = T) # Area em m^2 lo que mas me ha asombrado / shocked / chocado / con sf, es que el processo de gridding de VEIN en qgis demoraba 10 minutos, pero usando sf rn R, demora 10 minutos Pero ahora vamos a leer datos meteorologicos y climaticos en grillas (RASTER) (next chpater) "],
["taller-raster-y-cubos-de-datos-vectoriales-aplicacion-de-software-de-informacion-geografica-y-modelado.html", "Chapter 4 Taller RASTER Y CUBOS DE DATOS VECTORIALES: Aplicación de software de información geográfica y modelado", " Chapter 4 Taller RASTER Y CUBOS DE DATOS VECTORIALES: Aplicación de software de información geográfica y modelado gracias Amanda Rehbein &lt;3 (amanda.rehbein@usp.br) Raster son informacion espaciales en una grilla espacial. En general, la informacion de las frillas tiene una distancia homogenea, Por ejemplo, vea las siguientes figuras: Por ejemplo, cada banda podria representar un tiempo. Como se ve, estos ne realidad son cubos de datos de varias dimensiones, sin embargo, pueden existir grillas irregulares, como las que osn bien represnetadas con el paquete stars Preparense, porque vamos a avanzar directamente en el fondo del mundo de los datos espacio/temporales grillados raster y stars raster es una clase y una libreria de R que representa datos en grillas, llamados raster stasr es una clase y una libreria de R que representa datos en grillas, llamados tambien rasters. Por lo tanto, stars y raster tienen conexiones para leer los datos en formato GDAL raster. Que quiere decir esto???? Quiere decir que, tal como GDAL lee vectores, tambien lee [raster]((https://gdal.org/drivers/raster/index.html).: Coomopor ejemplo: ASCII ENVI GeoTIFF JAXA PALSAR NetCDF GeoSpatial PDF R R Raster XYZ Vamos meterle manos a la obra, vamos a nadar en el mundo multidimensional de los raster y si no saben nadar aprenderan como los pajaros que aprenden ante la subita e inherente necesidada vital de sobrevivir. Antes de abrir los datos con los programas, vamos a ver que vamos tenemos library(ncdf4) nc_open(&quot;dados/pr_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1985-2004.nc&quot;) ## File dados/pr_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1985-2004.nc (NC_FORMAT_CLASSIC): ## ## 4 variables (excluding dimension variables): ## double lon_bnds[bnds,lon] ## double lat_bnds[bnds,lat] ## double time_bnds[bnds,time] ## double pr[lon,lat,time] ## standard_name: precipitation_flux ## long_name: Precipitation ## units: kg m-2 s-1 ## _FillValue: 1.00000002004088e+20 ## missing_value: 1.00000002004088e+20 ## comment: at surface; includes both liquid and solid phases from all types of clouds (both large-scale and convective) ## original_name: mo: m01s05i216 ## history: 2011-03-22T15:05:23 out-of-bounds adjustments: (-1e-07 &lt;= x &lt; 0.0) =&gt; set to 0.0 2011-03-22T15:05:23Z altered by CMOR: replaced missing value flag (-1.07374e+09) with standard missing value (1e+20). ## cell_methods: time: mean ## associated_files: baseURL: http://cmip-pcmdi.llnl.gov/CMIP5/dataLocation gridspecFile: gridspec_atmos_fx_HadGEM2-ES_historical_r0i0p0.nc areacella: areacella_fx_HadGEM2-ES_historical_r0i0p0.nc ## ## 4 dimensions: ## lon Size:192 ## standard_name: longitude ## long_name: longitude ## units: degrees_east ## axis: X ## bounds: lon_bnds ## bnds Size:2 ## lat Size:145 ## standard_name: latitude ## long_name: latitude ## units: degrees_north ## axis: Y ## bounds: lat_bnds ## time Size:19 *** is unlimited *** ## standard_name: time ## long_name: time ## bounds: time_bnds ## units: days since 1859-12-1 00:00:00 ## calendar: 360_day ## axis: T ## ## 30 global attributes: ## CDI: Climate Data Interface version ?? (http://mpimet.mpg.de/cdi) ## Conventions: CF-1.4 ## history: Sun Sep 08 00:37:13 2019: cdo selmon,1 tmp_SELTIME_SEASSUM_pr_Amon_HadGEM2-ES_historical_r1i1p1_198412-200511.nc pr_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1986-2004.nc ## Sun Sep 08 00:36:18 2019: cdo selyear,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004 tmp_SEASSUM_pr_Amon_HadGEM2-ES_historical_r1i1p1_198412-200511.nc tmp_SELTIME_SEASSUM_pr_Amon_HadGEM2-ES_historical_r1i1p1_198412-200511.nc ## Sun Sep 08 00:33:38 2019: cdo -b 64 seassum pr_Amon_HadGEM2-ES_historical_r1i1p1_198412-200511.nc tmp_SEASSUM_pr_Amon_HadGEM2-ES_historical_r1i1p1_198412-200511.nc ## MOHC pp to CMOR/NetCDF convertor (version 1.7.0) 2011-03-22T15:05:17Z CMOR rewrote data to comply with CF standards and CMIP5 requirements. ## source: HadGEM2-ES (2009) atmosphere: HadGAM2 (N96L38); ocean: HadGOM2 (lat: 1.0-0.3 lon: 1.0 L40); land-surface/vegetation: MOSES2 and TRIFFID; tropospheric chemistry: UKCA; ocean biogeochemistry: diat-HadOCC ## institution: Met Office Hadley Centre, Fitzroy Road, Exeter, Devon, EX1 3PB, UK, (http://www.metoffice.gov.uk) ## institute_id: MOHC ## experiment_id: historical ## model_id: HadGEM2-ES ## forcing: GHG, SA, Oz, LU, Sl, Vl, BC, OC, (GHG = CO2, N2O, CH4, CFCs) ## parent_experiment_id: piControl ## parent_experiment_rip: r1i1p1 ## branch_time: 0 ## contact: chris.d.jones@metoffice.gov.uk, michael.sanderson@metoffice.gov.uk ## references: Bellouin N. et al, (2007) Improved representation of aerosols for HadGEM2. Meteorological Office Hadley Centre, Technical Note 73, March 2007; Collins W.J. et al, (2008) Evaluation of the HadGEM2 model. Meteorological Office Hadley Centre, Technical Note 74,; Johns T.C. et al, (2006) The new Hadley Centre climate model HadGEM1: Evaluation of coupled simulations. Journal of Climate, American Meteorological Society, Vol. 19, No. 7, pages 1327-1353.; Martin G.M. et al, (2006) The physical properties of the atmosphere in the new Hadley Centre Global Environmental Model, HadGEM1 - Part 1: Model description and global climatology. Journal of Climate, American Meteorological Society, Vol. 19, No.7, pages 1274-1301.; Ringer M.A. et al, (2006) The physical properties of the atmosphere in the new Hadley Centre Global Environmental Model, HadGEM1 - Part 2: Aspects of variability and regional climate. Journal of Climate, American Meteorological Society, Vol. 19, No. 7, pages 1302-1326. ## initialization_method: 1 ## physics_version: 1 ## tracking_id: 15cb947c-34d2-4da2-b830-9dd0123d96d3 ## mo_runid: ajhoh ## product: output ## experiment: historical ## frequency: mon ## creation_date: 2011-03-22T19:30:17Z ## project_id: CMIP5 ## table_id: Table Amon (06 January 2011) 085e3f5c098d203b2fd5d296226f41b3 ## title: HadGEM2-ES model output prepared for CMIP5 historical ## parent_experiment: pre-industrial control ## modeling_realm: atmos ## realization: 1 ## cmor_version: 2.5.3 ## CDO: Climate Data Operators version 1.7.2 (http://mpimet.mpg.de/cdo) ERA5! library(stars) pcp_era5 &lt;- read_stars(&quot;dados/pr_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1985-2004.nc&quot;) names(pcp_era5) str(pcp_era5) head(pcp_era5) brick es como literalmente un ladrillo considerndo usualmente la dimension tempral como un ladrillo. como vemos, la funcion str entrega mucha informacion. Esta funcion no es comunmente usada, pero su archivo de documentacion es ?str ERA5, investiguen! Vamos a plotear estos datos! library(stars) ## Loading required package: abind library(cptcity) pcp_era5 &lt;- read_stars(&quot;dados/pr_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1985-2004.nc&quot;) plot(pcp_era5, col = lucky(), axes = TRUE) ## Colour gradient: ma_fruit_fruit_01, number: 4842 Ahora vamos voy a mostrar todo un script para hacer graficos y analizar datos climaticos usando la libreria raster # ------------------------------------# # Precipitacion y temperatura medias # # Verano y invierno # # (very simple analysis) # # ------------------------------------# library(raster) ## Loading required package: sp library(cptcity) path &lt;- &quot;dados&quot; # DJF - VERANO: #### # Open the precipitation file: pcp_era5 &lt;- brick(&quot;dados/r_ERA5_pcp_DJF_1985-2004.nc&quot;) # Print information and metadata: pcp_era5 # This file has 17 layers (years) ## class : RasterBrick ## dimensions : 145, 192, 27840, 21 (nrow, ncol, ncell, nlayers) ## resolution : 1.875, 1.25 (x, y) ## extent : -0.9375, 359.0625, -90.625, 90.625 (xmin, xmax, ymin, ymax) ## crs : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 ## source : /home/sergio/Documents/UBA/dados/r_ERA5_pcp_DJF_1985-2004.nc ## names : X1984.01.16.12.06.28, X1985.01.01.00.06.28, X1986.01.01.01.06.28, X1987.01.01.01.06.28, X1988.01.01.01.06.28, X1989.01.01.01.06.28, X1990.01.01.01.06.28, X1991.01.01.01.06.28, X1992.01.01.01.06.28, X1993.01.01.01.06.28, X1994.01.01.01.06.28, X1995.01.01.01.06.28, X1996.01.01.01.06.28, X1997.01.01.01.06.28, X1998.01.01.01.06.28, ... ## Date/time : 1984-01-16 12:06:28, 2005-12-01 01:06:28 (min, max) ## varname : mtpr # Plot the 1st time/year: plot(pcp_era5[[1]]*3600) # *3600 to obtain mm/h # Calculate the mean: mean_pcp_era &lt;- mean(pcp_era5*3600) # Opening CMIP5 data model: HadGEM2-ES\\ pcp_historical &lt;- brick(&quot;dados/pr_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1985-2004.nc&quot;) plot(pcp_historical[[1]]*3600) mean_pcp_historical &lt;- mean(pcp_historical*3600) plot(mean_pcp_historical[[1]]*3600, main = &quot;HadGEM2-ES mean precipitation [mm/h] \\n DJF (1985 - 2004)&quot;) a &lt;- spplot(mean_pcp_era, interpolate = T, main = &quot;Observed Precipitation [mm/h] (ERA5) \\n DJF (1985 - 2004)&quot;, at = seq(0, 4, 0.1), col.regions = cpt(&quot;ncl_precip2_17lev&quot;)) b &lt;- spplot(mean_pcp_historical, main = &quot;Simulated precipitation [mm/h] (HadGEM2-ES) \\n DJF (1985 - 2004)&quot;, at = seq(0, 4, 0.1), col.regions = cpt(&quot;ncl_precip2_17lev&quot;)) gridExtra::grid.arrange(a, b, ncol = 2) Ahora vamos a ver la temperatura # Temperature #### t2m_era5 &lt;- brick(&quot;dados/r_ERA5_t2m_DJF_1985-2004.nc&quot;) t2m_era5 ## class : RasterBrick ## dimensions : 145, 192, 27840, 17 (nrow, ncol, ncell, nlayers) ## resolution : 1.875, 1.25 (x, y) ## extent : -0.9375, 359.0625, -90.625, 90.625 (xmin, xmax, ymin, ymax) ## crs : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 ## source : /home/sergio/Documents/UBA/dados/r_ERA5_t2m_DJF_1985-2004.nc ## names : X1986.01.01.01.06.28, X1987.01.01.01.06.28, X1988.01.01.01.06.28, X1989.01.01.01.06.28, X1990.01.01.01.06.28, X1991.01.01.01.06.28, X1992.01.01.01.06.28, X1993.01.01.01.06.28, X1994.01.01.01.06.28, X1995.01.01.01.06.28, X1996.01.01.01.06.28, X1997.01.01.01.06.28, X1998.01.01.01.06.28, X1999.01.01.01.06.28, X2000.01.01.01.06.28, ... ## Date/time : 1986-01-01 01:06:28, 2004-01-01 01:06:28 (min, max) ## varname : t2m plot(t2m_era5[[1]] - 273.15) # -273.15 to obtain ºC mean_t2m_era &lt;- mean(t2m_era5 -273.15) t2m_historical &lt;- brick(&quot;dados/tas_Amon_HadGEM2-ES_historical_r1i1p1_DJF_1985-2004.nc&quot;) plot(t2m_historical[[1]] - 273.15) mean_t2m_historical &lt;- mean(t2m_historical - 273.15) c &lt;- spplot(mean_t2m_era, main = &quot;Observed temperature at 2m [ºC] (ERA5) \\n DJF (1985 - 2004)&quot;, at = seq(-40, 40, 1), col.regions = cpt(&quot;ncl_temp_diff_18lev&quot;)) d &lt;- spplot(mean_t2m_historical, main = &quot;Simulated temperature at 2m [ºC] (HadGEM2-ES) \\n DJF (1985 - 2004)&quot;, at = seq(-40, 40, 1), col.regions = cpt(&quot;ncl_temp_diff_18lev&quot;)) gridExtra::grid.arrange(c, d, ncol = 2) # Calculate the bias (how model is different from the observation): pcp_bias &lt;- (mean_pcp_historical - mean_pcp_era) t2m_bias &lt;- (mean_t2m_historical - mean_t2m_era) f &lt;- spplot(pcp_bias, main = &quot;Precipitation bias [mm/h] \\n DJF (1985 - 2004)&quot;, at = seq(-3, 3, 0.1), col.regions = cpt(&quot;ncl_precip_diff_12lev&quot;)) g &lt;- spplot(t2m_bias, main = &quot;Temperature bias [ºC] \\n DJF (1985 - 2004)&quot;, at = seq(-15, 15, 1), col.regions = cpt(&quot;ncl_temp_diff_18lev&quot;)) gridExtra::grid.arrange(f, g, ncol = 2) gridExtra::grid.arrange(a, b, f, c, d, g, ncol = 3) # JJA - invierno: #### # Try it by your self. "],
["estudios-de-series-de-tiempo-para-asociar-salud-y-variables-ambientales.html", "Chapter 5 Estudios de series de tiempo para asociar salud y variables ambientales 5.1 Distribucion 5.2 Efecto de la contaminacion 5.3 Efecto de la temperatura", " Chapter 5 Estudios de series de tiempo para asociar salud y variables ambientales Uno de los metodos mas validados y establecidos para identificar asociaciones entre mortalidad, morbilidad, y otros parametros con variables ambientales son las series de tiempo. Algunos de los autores clasicos sobre este tipo de estudios estan: Francesca Dominici [link google scholar] Luis Cifuentes [link google scholar] Petros Koutrakis [link google scholar] Paulo Saldiva [link google scholar] Michelle Bell [link google scholar] Antonela Zanometti [link google scholar] Francesca Dominici ha publicado diferentes estudios y actualizado la metodologia de estudios de series de tiempo considerando la distribucion estadistica, control de los factores de confusion y modelos generales aditivos. 5.1 Distribucion Los estudios de series de tiempo consideran en general variables diarias. En este sentido, las variables de salud son conteos diarios con una distribucion apropiada, generalmente Poisson o Binomail Negativa, por ejemplo. Estas son diferentes de la distribucion normal. Densidad de la distribucion de Poisson: \\[\\begin{equation} p(x) = \\lambda^x exp(-\\lambda)/x! \\tag{2.12} \\end{equation}\\] Densidad de la distribucion de Normal: \\[\\begin{equation} f(x) = 1/( (2 \\pi) \\sigma) e^-((x - \\mu)^2/(2 \\sigma^2)^0.5 ) \\tag{5.1} \\end{equation}\\] Vamos a ver un ejemplo: 5.2 Efecto de la contaminacion Dominici presento el modelo semi-parametrico usando modelos generales aditivos (Wood 2017) para el estudio de series de tiempo. Este modelo consiste en: \\[\\begin{equation} log(m) = \\beta_0 + \\beta_1 \\cdot X_i + s(meteo) + s(time) + s(season) + ... \\tag{5.1} \\end{equation}\\] Donde m es la variable dependiente sobre salud, \\(\\beta\\) son los coeficientes, \\(X_i\\) son los contaminantes, \\(s\\) es una funcion spline Luego, la asociacion resultante es el riesgo relativo (Abrutzky et al. 2013): \\[\\begin{equation} RR = exp(\\beta_i \\cdot \\delta X_i) \\tag{5.1} \\end{equation}\\] Que indica el riesgo relativo dada un cambio en la variable, por ejemplo, si se incrementan las concentraciones de PM10 en 50 ug/m3, el riesgo de mortalidad respiratoria aumenta 7%. Aplicando este porcentaje sobre la poblacion es posible calcular la mortalidad anual asociada a la contaminacion. Vamos a ver valores reales para Argentina y Chile (Abrutzky et al. 2013). Figure 5.1: Riesgo relativo en mortalidad por incremento de 1 ppm de CO (Abrutzky et al., 2013) 5.3 Efecto de la temperatura Puede se utilizada la misma metodologia pero considerando variables meteorologicas en este caso. Un trabajo muy interesante recientemente publicado por el grupo de Paulo Saliva es el efecto de la temperatura en diferentes ciudades del mundo (Gasparrini et al. 2015). Figure 5.2: Riesgo relativo en mortalidad por incremento de 1 ppm de CO (Abrutzky et al., 2013) References "],
["references.html", "References", " References "]
]
